{"version":3,"file":"static/js/729.73f7dcbd.chunk.js","mappings":"mBA6BCA,WAAmBC,UAAY,SAAUC,GACtC,MAAM,KAAEC,EAAI,cAAEC,GAAkBF,EAAMC,KAChCE,EAAoC,GAO1C,GAJAC,QAAQC,IAAI,yBAA0BJ,GACtCG,QAAQC,IAAI,mCAAoCH,GAChDE,QAAQC,IAAI,+BAAgCJ,EAAOA,EAAKK,OAAS,IAE5DC,MAAMC,QAAQP,IAAyB,IAAhBA,EAAKK,OAE7B,YADAF,QAAQK,KAAK,2CAOjBR,EAAKS,SAAQ,CAACC,EAA6BC,KACvC,MAAMC,EAAMC,WAAWC,OAAOJ,EAA2B,WACnDK,EAAKF,WAAWC,OAAOJ,EAA4B,YAEzD,GAAmB,kBAARE,GAAkC,kBAAPG,GAAoBC,MAAMJ,IAASI,MAAMD,GA0B3EZ,QAAQC,IAAI,OAAQQ,EAAK,QAASG,GAClCZ,QAAQK,KAAK,0GAA2GE,GACxHP,QAAQK,KAAK,eAAgBI,EAAK,cAAeG,OA5B+B,CAChF,MAAME,EAA6B,GACnC,IAAK,IAAIC,KAAOR,EAAgB,CAC5B,GAAU,YAAPQ,EACC,SAGJ,MAAMC,EAAyB,KAAjBlB,EAAuB,CACjCmB,cAAeF,EACfG,QAASH,GACTjB,EAAcqB,MAAKC,GAAKA,EAAEH,gBAAkBF,IAE5CC,GACAF,EAAUO,KAAK,CACXC,MAAON,EAAME,SAAWF,EAAMC,cAC9BM,MAAOhB,EAAeQ,IAGlC,CAEAhB,EAAgBsB,KAAK,CACjBG,KAAM,CAACf,EAAKG,GACZE,UAAWA,GAGnB,CAOIf,EAAgBG,OAAS,KAAOM,EAAQ,GAlD9B,KAkDiD,GAAMA,EAAQ,IAAOX,EAAKK,UACrFF,QAAQC,IAAI,+BAA+BF,EAAgBG,kBAC1DR,WAAmB+B,YAAYC,gBAAgB3B,IAChDA,EAAgBG,OAAS,EAC7B,IAIAH,EAAgBG,OAAS,IACzBF,QAAQC,IAAI,4CAA4CF,EAAgBG,kBACvER,WAAmB+B,YAAYC,gBAAgB3B,KAGpDC,QAAQC,IAAI,kEAChB,EAEAD,QAAQC,IAAI,gE","sources":["workers/ElementContainerWorker.ts"],"sourcesContent":["/* eslint-env worker */\n\ninterface ElementData {\n    latitude: string | number;\n    longitude: string | number;\n    [key: string]: any;\n}\n\ninterface FieldKey {\n    originaleName: string;\n    renamed?: string;\n}\n\ninterface WorkerInputData {\n    data: ElementData[];\n    fieldKeyListe: FieldKey[] | '*';\n}\n\ninterface PopUpDataItem {\n    label: string;\n    value: any;\n}\n\ninterface ProcessedPoint {\n    coor: [number, number];\n    popUpData: PopUpDataItem[];\n}\n\n// Use globalThis instead of self to avoid ESLint no-restricted-globals\n(globalThis as any).onmessage = function (event: MessageEvent<WorkerInputData>) {\n    const { data, fieldKeyListe } = event.data;\n    const processedPoints: ProcessedPoint[] = [];\n    const chunkSize = 20;\n\n    console.log('Worker: Data received:', data);\n    console.log('Worker: Field Key List received:', fieldKeyListe);\n    console.log('Worker: Initial data length:', data ? data.length : 0);\n\n    if (!Array.isArray(data) || data.length === 0) {\n        console.warn('Worker: No valid data array to process.');\n        return;\n    }\n\n    const LATITUDE_KEY = 'latitude';\n    const LONGITUDE_KEY = 'longitude';\n\n    data.forEach((currentElement: ElementData, index: number) => {\n        const lat = parseFloat(String(currentElement[LATITUDE_KEY]));\n        const lg = parseFloat(String(currentElement[LONGITUDE_KEY]));\n\n        if (typeof lat === 'number' && typeof lg === 'number' && !isNaN(lat) && !isNaN(lg)) {\n            const popUpData: PopUpDataItem[] = [];\n            for (let key in currentElement) {\n                if(key == 'textIcon'){\n                    continue;\n                }\n                \n                const field = fieldKeyListe == '*' ? {\n                    originaleName: key,\n                    renamed: key\n                } : fieldKeyListe.find(x => x.originaleName === key);\n\n                if (field) {\n                    popUpData.push({\n                        label: field.renamed || field.originaleName,\n                        value: currentElement[key]\n                    });\n                }\n            }\n\n            processedPoints.push({\n                coor: [lat, lg],\n                popUpData: popUpData\n            });\n\n        } else {\n            console.log('lat:', lat, '| lg:', lg);\n            console.warn('Worker: ElementContainerWorker.ts a ignorer des elements car ils ont pas de champs de coordonee valides', currentElement);\n            console.warn('  Latitude :', lat, 'Longitude :', lg);\n        }\n\n        // Envoyer les points par paquet pour un affichage progressif\n        if (processedPoints.length > 0 && ((index + 1) % chunkSize === 0 || (index + 1) === data.length)) {\n            console.log(`Worker: envoie de paquet de ${processedPoints.length} points.`);\n            (globalThis as any).postMessage(structuredClone(processedPoints));\n            processedPoints.length = 0;\n        }\n    });\n\n    // Envoyer le dernier paquet s'il reste des points\n    if (processedPoints.length > 0) {\n        console.log(`Worker: a envoyer ses derniers paquet de ${processedPoints.length} points.`);\n        (globalThis as any).postMessage(structuredClone(processedPoints));\n    }\n\n    console.log('Worker: ElementContainerWorker.ts a finit tout ses traitements.');\n};\n\nconsole.log('Worker: ElementContainerWorker.ts est en cours de chargement.');\n\nexport { };"],"names":["globalThis","onmessage","event","data","fieldKeyListe","processedPoints","console","log","length","Array","isArray","warn","forEach","currentElement","index","lat","parseFloat","String","lg","isNaN","popUpData","key","field","originaleName","renamed","find","x","push","label","value","coor","postMessage","structuredClone"],"sourceRoot":""}